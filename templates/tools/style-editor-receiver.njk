---
title: "Style Editor Receiver"
description: "Enables live CSS variable editing from the Forestry dashboard. Install this component to use the Style Editor feature."
version: "1.1.0"
author: "Forestry.md"
category: "Tools"
defaultSlot: "head"
variables: {}
---

<script>
(function() {
    // Only activate when loaded in an iframe
    if (window.parent === window) return;

    window.addEventListener('message', function(event) {
        var data = event.data;
        if (!data || !data.type) return;

        // Respond to ping with pong (for connection detection)
        if (data.type === 'ping') {
            window.parent.postMessage({ type: 'pong' }, '*');
            return;
        }

        if (data.type === 'setCSS') {
            // Set a single CSS variable
            document.body.style.setProperty(data.variableName, data.value);
        } else if (data.type === 'resetCSS') {
            // Remove a single CSS variable override
            document.body.style.removeProperty(data.variableName);
        } else if (data.type === 'bulkSetCSS') {
            // Apply multiple variables at once
            if (data.variables && typeof data.variables === 'object') {
                Object.keys(data.variables).forEach(function(name) {
                    document.body.style.setProperty(name, data.variables[name]);
                });
            }
        } else if (data.type === 'resetAllCSS') {
            // Clear all inline style overrides
            document.body.removeAttribute('style');
        } else if (data.type === 'getComputedCSS') {
            // Return computed values for requested variables
            var computed = {};
            var styles = getComputedStyle(document.body);
            if (Array.isArray(data.variableNames)) {
                data.variableNames.forEach(function(name) {
                    computed[name] = styles.getPropertyValue(name).trim();
                });
            }
            window.parent.postMessage({
                type: 'computedCSS',
                variables: computed
            }, event.origin);
        }
    });

    // Send ready message immediately and periodically until parent acknowledges
    function sendReady() {
        window.parent.postMessage({ type: 'styleEditorReady' }, '*');
    }
    sendReady();
    var readyInterval = setInterval(sendReady, 1000);

    // Stop sending ready messages once we receive any message from parent
    window.addEventListener('message', function stopReady(event) {
        if (event.data && event.data.type) {
            clearInterval(readyInterval);
            window.removeEventListener('message', stopReady);
        }
    });
})();
</script>
